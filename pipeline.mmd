flowchart TD
    p0((Channel.fromPath))
    p1([splitFasta])
    p2[multipleSequenceAlignmentAnalysis:createMultipleSequenceAlignment]
    p3[multipleSequenceAlignmentAnalysis:buildPhilogeneticTree]
    p4[multipleSequenceAlignmentAnalysis:renderTree]
    p5[multipleSequenceAlignmentAnalysis:buildLogo]
    p6[b2bToolsAnalysis:predictBiophysicalFeatures]
    p7[b2bToolsAnalysis:plotBiophysicalFeatures]
    p8[b2bToolsAnalysis:plotAgmata]
    p9([splitFasta])
    p10([filter])
    p11[fetchStructure]
    p12([collect])
    p13([collect])
    p14([collect])
    p15([collect])
    p16[compressPredictions]
    p17(( ))
    p0 -->|allSequences| p1
    p1 -->|sequencesGrouped| p6
    p0 -->|allSequences| p2
    p2 -->|multipleSequenceAlignment| p3
    p3 -->|tree| p4
    p4 -->|treePlot| p16
    p2 -->|multipleSequenceAlignment| p5
    p5 -->|logo| p16
    p6 -->|predictions| p7
    p7 -->|plots| p13
    p6 -->|predictions| p8
    p8 -->|agmata_plots| p14
    p0 -->|allSequences| p9
    p9 --> p10
    p10 --> p11
    p11 --> p15
    p6 -->|predictions| p12
    p12 --> p16
    p13 --> p16
    p14 --> p16
    p15 --> p16
    p2 -->|multipleSequenceAlignment| p16
    p3 -->|tree| p16
    p16 --> p17
